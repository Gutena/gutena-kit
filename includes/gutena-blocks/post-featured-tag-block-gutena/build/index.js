(()=>{"use strict";const e=window.wp.blocks,t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"gutena/post-featured-tag","title":"Post Featured Tag","category":"gutena","icon":"tag","description":"Post featured tag block use to add custom featured or new tag on post based on post date.","textdomain":"post-featured-tag-block-gutena","supports":{"html":false},"attributes":{"hideAfter":{"type":"integer"},"latestPost":{"type":"boolean"}},"usesContext":["postId","postType"],"editorScript":"file:./index.js"}'),o=window.wp.element,a=window.wp.i18n,n=window.wp.data,s=window.wp.coreData,r=window.wp.components,l=window.wp.blockEditor,c=[["core/buttons"]];(0,e.registerBlockType)(t,{edit:function(e){let{attributes:t,context:p,setAttributes:i}=e;const d=(0,l.useBlockProps)(),u=(0,o.createElement)(l.InspectorControls,{key:"settings"},(0,o.createElement)(r.PanelBody,{title:(0,a.__)("Settings","post-featured-tag-block-gutena")},(0,o.createElement)(r.ToggleControl,{label:(0,a.__)("Show Tag only on Latest Post","post-featured-tag-block-gutena"),checked:t.latestPost,onChange:()=>i({latestPost:!t.latestPost})}),(0,o.createElement)(r.RangeControl,{label:(0,a.__)("Hide Tag after (in days)","post-featured-tag-block-gutena"),value:t.hideAfter,onChange:e=>i({hideAfter:e}),min:0,max:30,allowReset:!0}))),{latestPosts:g}=(0,n.useSelect)((e=>{const{getEntityRecords:t}=e(s.store);return{latestPosts:t("postType",p.postType,{per_page:1})}}),[]),w=!(null==g||!g.length),[m,f]=(0,s.useEntityProp)("postType",p.postType,"date",p.postId);let h=!0;return""!=t.hideAfter&&0!=t.hideAfter&&((e,t)=>{const o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((a-o)/864e5)})(new Date(m),new Date)>t.hideAfter&&(h=!1),t.latestPost&&h&&w&&(h=g[0].id==p.postId),(0,o.createElement)(o.Fragment,null,u,h?(0,o.createElement)("div",d,(0,o.createElement)(l.InnerBlocks,{template:c})):(0,o.createElement)(o.Fragment,null))},save:function(){const e=l.useBlockProps.save({className:"post-featured-tag-block-gutena"});return(0,o.createElement)("div",e,(0,o.createElement)(l.InnerBlocks.Content,null))}})})();